<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <!-- start custom head snippets -->

    <!-- insert favicons. use https://realfavicongenerator.net/ -->

    <!-- Github Button
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script> -->

    <!--<![endif]-->
    <!-- end custom head snippets -->

    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"
    ></script>
    <script src="/assets/js/typewrite.min.js"></script>

    <meta charset="utf-8" />

    <!-- begin _includes/seo.html -->
    <title>Decision Tree - Hun’s Blog</title>
    <meta
      name="description"
      content="Supervised Machine Learning (Classification)"
    />

    <meta name="author" content="Younghun Lee" />

    <meta property="article:author" content="Younghun Lee" />

    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="Hun's Blog" />
    <meta property="og:title" content="Decision Tree" />
    <meta property="og:url" content="https://leeway00.github.io/ibm/cls3/" />

    <meta
      property="og:description"
      content="Supervised Machine Learning (Classification)"
    />

    <meta
      property="article:published_time"
      content="2022-05-05T00:00:00+00:00"
    />

    <meta
      property="article:modified_time"
      content="2022-05-22T14:42:08+00:00"
    />

    <link rel="canonical" href="https://leeway00.github.io/ibm/cls3/" />

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",

        "@type": "Person",
        "name": "Younghun Lee",
        "url": "https://leeway00.github.io/"
      }
    </script>

    <!-- end _includes/seo.html -->

    <link
      href="/feed.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Hun's Blog Feed"
    />

    <!-- https://t.co/dKP3o1e -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script>
      document.documentElement.className =
        document.documentElement.className.replace(/\bno-js\b/g, "") + " js ";
    </script>

    <!-- For all browsers -->
    <link rel="stylesheet" href="/assets/css/main.css" />
    <link
      rel="preload"
      href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"
    /></noscript>
  </head>

  <body class="layout--single_v2">
    <nav class="skip-links">
      <ul>
        <li>
          <a href="#site-nav" class="screen-reader-shortcut"
            >Skip to primary navigation</a
          >
        </li>
        <li>
          <a href="#main" class="screen-reader-shortcut">Skip to content</a>
        </li>
        <li>
          <a href="#footer" class="screen-reader-shortcut">Skip to footer</a>
        </li>
      </ul>
    </nav>

    <!--[if lt IE 9]>
      <div class="notice--danger align-center" style="margin: 0">
        You are using an <strong>outdated</strong> browser. Please
        <a href="https://browsehappy.com/">upgrade your browser</a> to improve
        your experience.
      </div>
    <![endif]-->

    <div class="masthead">
      <div class="masthead__inner-wrap">
        <div class="masthead__menu">
          <nav id="site-nav" class="greedy-nav">
            <a class="site-title" href="/">
              Hun's Blog
              <span class="site-subtitle">Powered by Yobi Isi❤️</span>
            </a>
            <ul class="visible-links">
              <li class="masthead__menu-item">
                <a href="/categories/ibm-machine-learning/">IBM Notes</a>
              </li>
              <li class="masthead__menu-item">
                <a href="/categories/time-series/">Time Series</a>
              </li>
              <li class="masthead__menu-item"></li>
            </ul>

            <button class="greedy-nav__toggle hidden" type="button">
              <span class="visually-hidden">Toggle menu</span>
              <div class="navicon"></div>
            </button>
            <ul class="hidden-links hidden"></ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- <script>
    var elements = document.querySelectorAll('.page__content.e-content').childNodes; // 수정1 
    var addContent = false;
    var contentsToAdd = [];
    var expandtags = null;
    var detailText = null;
    var detailsTag = null;
    var summaryTag = null;
    var detailsContent = null;
    for (var i=elements.length - 1; i > -1; i--){
        el = elements[i]
        if (el.innerHTML == '[/expand]'){
            addContent = true
            detailsContent = document.createElement('div')
            detailsContent.className = 'collaspe-content'
            detailsContent.setAttribute('markdown', '1')
            el.parentNode.removeChild(el)
        } else if (el.innerHTML == '[expand]' || (el.nodeName == 'P' && el.innerHTML.includes('[expand]summary:'))) {
            addContent = false
            expandtags = el.innerHTML.split('summary:')
            if (expandtags.length == 1){
                detailText = 'Details'
            } else {
                detailText = expandtags[1]
            }
            detailsTag = document.createElement('details')
            detailsTag.className = 'collaspe-article'
            summaryTag = document.createElement('summary')
            summaryTag.appendChild(document.createTextNode(detailText))
            detailsTag.appendChild(summaryTag)
            for (var j=contentsToAdd.length - 1; j > -1; j--) {
                detailsContent.appendChild(contentsToAdd[j])
            }
            detailsTag.appendChild(detailsContent)
            el.parentNode.replaceChild(detailsTag, el)
            contentsToAdd = []
        } else {
            if (addContent) {
                contentsToAdd.push(el)
            }
        }
    }
</script> -->

    <div class="initial-content">
      <!-- 
  Changed
  1. Moved tag, categories (page__meta) under the title (page__inner-wrap).
  2. 
-->

      <div id="main" role="main">
        <div class="sidebar sticky">
          <div itemscope itemtype="https://schema.org/Person" class="h-card">
            <div class="author__avatar">
              <a href="https://leeway00.github.io/">
                <img
                  src="/assets/images/profile_yh.png"
                  alt="Younghun Lee"
                  itemprop="image"
                  class="u-photo"
                />
              </a>
            </div>

            <div class="author__content">
              <h3 class="author__name p-name" itemprop="name">
                <a
                  class="u-url"
                  rel="me"
                  href="https://leeway00.github.io/"
                  itemprop="url"
                  >Younghun Lee</a
                >
              </h3>

              <div class="author__bio p-note" itemprop="description">
                <p>Student</p>
              </div>
            </div>

            <div class="author__urls-wrapper">
              <button class="btn btn--inverse">Follow</button>
              <ul class="author__urls social-icons">
                <li
                  itemprop="homeLocation"
                  itemscope
                  itemtype="https://schema.org/Place"
                >
                  <a
                    ><i
                      class="fas fa-fw fa-map-marker-alt"
                      aria-hidden="true"
                    ></i>
                    <span itemprop="name" class="p-locality">Somewhere</span></a
                  >
                </li>

                <li>
                  <a
                    href="mailto:leeyh0920@gmail.com"
                    rel="nofollow noopener noreferrer me"
                    ><i
                      class="fas fa-fw fa-envelope-square"
                      aria-hidden="true"
                    ></i
                    ><span class="label">Personal Email</span></a
                  >
                </li>

                <li>
                  <a
                    href="https://leeway00@github.com/"
                    rel="nofollow noopener noreferrer me"
                    ><i class="fab fa-fw fa-github" aria-hidden="true"></i
                    ><span class="label">GitHub</span></a
                  >
                </li>

                <li>
                  <a
                    href="https://linkedin.com/in/younghunlee"
                    rel="nofollow noopener noreferrer me"
                    ><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i
                    ><span class="label">linkedin</span></a
                  >
                </li>

                <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
              </ul>
            </div>
          </div>

          <nav class="nav__list">
            <input id="ac-toc" name="accordion-toc" type="checkbox" />
            <label for="ac-toc">Toggle menu</label>
            <ul class="nav__items"></ul>
          </nav>

          <!--전체 글 수를 세기 위한 연산. sum 변수에 전체 글 수 저장-->

          <nav class="nav__list">
            <input id="ac-toc" name="accordion-toc" type="checkbox" />
            <label for="ac-toc">Toggle menu</label>
            <ul class="nav__items" id="category_tag_menu">
              <!--전체 글 수-->
              <li>
                📂
                <span style="font-family: 'Cafe24Oneprettynight'"
                  >Total Posts #</span
                >
                <span style="font-family: 'Coming Soon'">21</span>
                <span style="font-family: 'Cafe24Oneprettynight'"></span>
              </li>
              <li>
                <!--span 태그로 카테고리들을 크게 분류 ex) C/C++-->
                <span class="nav__sub-title">Machine Learning</span>
                <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
                <ul>
                  <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                  <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시-->

                  <li>
                    <a href="/categories/ibm-machine-learning" class=""
                      >IBM (17)</a
                    >
                  </li>
                </ul>
                <!--ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul-->
                <span class="nav__sub-title">Statistics</span>
                <ul>
                  <li>
                    <a href="/categories/time-series" class=""
                      >Time Series (1)</a
                    >
                  </li>
                </ul>
              </li>
            </ul>
          </nav>
        </div>

        <article
          class="page h-entry"
          itemscope
          itemtype="https://schema.org/CreativeWork"
        >
          <meta itemprop="headline" content="Decision Tree" />
          <meta
            itemprop="description"
            content="Supervised Machine Learning (Classification)"
          />
          <meta itemprop="datePublished" content="2022-05-05T00:00:00+00:00" />
          <meta itemprop="dateModified" content="2022-05-22T14:42:08+00:00" />

          <div class="page__inner-wrap">
            <header>
              <h1
                id="page-title"
                class="page__title p-name"
                itemprop="headline"
              >
                <a
                  href="https://leeway00.github.io/ibm/cls3/"
                  class="u-url"
                  itemprop="url"
                  >Decision Tree
                </a>
              </h1>
            </header>

            <header class="page__meta">
              <small>
                <p class="page__taxonomy">
                  <strong>
                    <i class="fas fa-fw fa-tags" aria-hidden="true"></i>
                    Tags:
                  </strong>
                  <span itemprop="keywords">
                    <a
                      href="/tags/classification"
                      class="page__taxonomy-item p-category"
                      rel="tag"
                      >Classification</a
                    ><span class="sep">, </span>

                    <a
                      href="/tags/decision-tree"
                      class="page__taxonomy-item p-category"
                      rel="tag"
                      >Decision Tree</a
                    ><span class="sep">, </span>

                    <a
                      href="/tags/supervised"
                      class="page__taxonomy-item p-category"
                      rel="tag"
                      >Supervised</a
                    ><span class="sep">, </span>

                    <a
                      href="/tags/week3"
                      class="page__taxonomy-item p-category"
                      rel="tag"
                      >Week3</a
                    >
                  </span>
                </p>

                <p class="page__taxonomy">
                  <strong>
                    <i class="fas fa-fw fa-folder-open" aria-hidden="true"></i>
                    Categories:
                  </strong>
                  <span itemprop="keywords">
                    <a
                      href="/categories/ibm-machine-learning"
                      class="page__taxonomy-item p-category"
                      rel="tag"
                      >IBM Machine Learning</a
                    >
                  </span>
                </p>

                <p class="page__date">
                  <strong
                    ><i
                      class="fas fa-fw fa-calendar-alt"
                      aria-hidden="true"
                    ></i>
                    Updated:</strong
                  >
                  <time class="dt-published" datetime="2022-05-22"
                    >May 22, 2022</time
                  >
                </p>
              </small>
              <hr />
            </header>

            <section class="page__content e-content" itemprop="text">
              <aside class="sidebar__right sticky">
                <nav class="toc">
                  <header>
                    <h4 class="nav__title">
                      <i class="fas fa-file-alt"></i> On this page
                    </h4>
                  </header>
                  <ul class="toc__menu">
                    <li>
                      <a href="#decision-tree">Decision Tree</a>
                      <ul>
                        <li>
                          <a href="#splitting-criteria">Splitting Criteria</a>
                        </li>
                        <li>
                          <a href="#characteristics-of-a-decision-tree"
                            >Characteristics of a Decision Tree</a
                          >
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="#ensemble">Ensemble</a>
                      <ul>
                        <li>
                          <a href="#bagging">Bagging</a>
                          <ul>
                            <li>
                              <a href="#out-of-bag-score">Out-of-Bag Score</a>
                            </li>
                            <li><a href="#random-forest">Random Forest</a></li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="#boosting">Boosting</a>
                      <ul>
                        <li>
                          <a href="#gradient-boosting-functions"
                            >Gradient Boosting Functions</a
                          >
                        </li>
                        <li><a href="#hyperparameters">Hyperparameters</a></li>
                        <li>
                          <a href="#stacking">Stacking</a>
                          <ul>
                            <li>
                              <a href="#hard-voting-vs-soft-voting"
                                >Hard voting vs Soft voting</a
                              >
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </nav>
              </aside>
              <h2 id="decision-tree">Decision Tree</h2>

              <p>Building a decision tree</p>
              <ol>
                <li>select a feature</li>
                <li>split the data into two groups.</li>
                <li>
                  Split until
                  <ol>
                    <li>the leaf node are pure (only one class remains)</li>
                    <li>The maximum depth of the tree is reached</li>
                    <li>A performance metric is achieved</li>
                  </ol>
                </li>
              </ol>

              <p>
                The decision tree uses a greedy search to find the best split at
                each step. The <strong>Best Split</strong> is the split that
                minimizes the <strong>information</strong>.\
              </p>

              <h3 id="splitting-criteria">Splitting Criteria</h3>
              <p>Classification Error Equation</p>

              <span class="katex-display"
                ><span class="katex"
                  ><span class="katex-mathml"
                    ><math
                      xmlns="http://www.w3.org/1998/Math/MathML"
                      display="block"
                      ><semantics
                        ><mrow
                          ><mi>E</mi><mo stretchy="false">(</mo><mi>t</mi
                          ><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn
                          ><mo>−</mo><mi>m</mi><mi>a</mi
                          ><msub><mi>x</mi><mi>i</mi></msub
                          ><mo stretchy="false">[</mo><mi>P</mi
                          ><mo stretchy="false">(</mo><mi>i</mi
                          ><mi mathvariant="normal">∣</mi><mi>t</mi
                          ><mo stretchy="false">)</mo
                          ><mo stretchy="false">]</mo></mrow
                        ><annotation encoding="application/x-tex"
                          >E(t) = 1-max_i[P(i|t)]</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.05764em"
                        >E</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose">)</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span
                      ><span class="mrel">=</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 0.7278em; vertical-align: -0.0833em"
                      ></span
                      ><span class="mord">1</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span
                      ><span class="mbin">−</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span class="mord mathnormal">ma</span
                      ><span class="mord"
                        ><span class="mord mathnormal">x</span
                        ><span class="msupsub"
                          ><span class="vlist-t vlist-t2"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.3117em"
                                ><span
                                  style="
                                    top: -2.55em;
                                    margin-left: 0em;
                                    margin-right: 0.05em;
                                  "
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mathnormal mtight"
                                      >i</span
                                    ></span
                                  ></span
                                ></span
                              ><span class="vlist-s">​</span></span
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.15em"
                                ><span></span></span></span></span></span></span
                      ><span class="mopen">[</span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.13889em"
                        >P</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">i</span
                      ><span class="mord">∣</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose">)]</span></span
                    ></span
                  ></span
                ></span
              >

              <p>
                But this metric does not change overall Error rate when parent
                node error is compared with weighted average of child node
                error.\
              </p>

              <p>Thus, we use Entroy Equation</p>

              <span class="katex-display"
                ><span class="katex"
                  ><span class="katex-mathml"
                    ><math
                      xmlns="http://www.w3.org/1998/Math/MathML"
                      display="block"
                      ><semantics
                        ><mrow
                          ><mi>H</mi><mo stretchy="false">(</mo><mi>t</mi
                          ><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo
                          ><munder><mo>∑</mo><mi>i</mi></munder
                          ><mo stretchy="false">[</mo><mi>P</mi
                          ><mo stretchy="false">(</mo><mi>i</mi
                          ><mi mathvariant="normal">∣</mi><mi>t</mi
                          ><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi
                          ><msub><mi>g</mi><mn>2</mn></msub
                          ><mo stretchy="false">(</mo><mi>P</mi
                          ><mo stretchy="false">(</mo><mi>i</mi
                          ><mi mathvariant="normal">∣</mi><mi>t</mi
                          ><mo stretchy="false">)</mo><mo stretchy="false">)</mo
                          ><mo stretchy="false">]</mo></mrow
                        ><annotation encoding="application/x-tex"
                          >H(t) = -\sum_i[P(i|t)log_2(P(i|t))]</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.08125em"
                        >H</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose">)</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span
                      ><span class="mrel">=</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 2.3277em; vertical-align: -1.2777em"
                      ></span
                      ><span class="mord">−</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.1667em"
                      ></span
                      ><span class="mop op-limits"
                        ><span class="vlist-t vlist-t2"
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 1.05em"
                              ><span style="top: -1.8723em; margin-left: 0em"
                                ><span
                                  class="pstrut"
                                  style="height: 3.05em"
                                ></span
                                ><span class="sizing reset-size6 size3 mtight"
                                  ><span class="mord mathnormal mtight"
                                    >i</span
                                  ></span
                                ></span
                              ><span style="top: -3.05em"
                                ><span
                                  class="pstrut"
                                  style="height: 3.05em"
                                ></span
                                ><span
                                  ><span class="mop op-symbol large-op"
                                    >∑</span
                                  ></span
                                ></span
                              ></span
                            ><span class="vlist-s">​</span></span
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 1.2777em"
                              ><span></span></span></span></span></span
                      ><span class="mopen">[</span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.13889em"
                        >P</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">i</span
                      ><span class="mord">∣</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose">)</span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.01968em"
                        >l</span
                      ><span class="mord mathnormal">o</span
                      ><span class="mord"
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.03588em"
                          >g</span
                        ><span class="msupsub"
                          ><span class="vlist-t vlist-t2"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.3011em"
                                ><span
                                  style="
                                    top: -2.55em;
                                    margin-left: -0.0359em;
                                    margin-right: 0.05em;
                                  "
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight">2</span></span
                                  ></span
                                ></span
                              ><span class="vlist-s">​</span></span
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.15em"
                                ><span></span></span></span></span></span></span
                      ><span class="mopen">(</span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.13889em"
                        >P</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">i</span
                      ><span class="mord">∣</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose">))]</span></span
                    ></span
                  ></span
                ></span
              >

              <p>
                <img src="/assets/images/IBM/DT_error.png" alt="smallcenter" />
              </p>

              <p>The Gini index is also used</p>

              <span class="katex-display"
                ><span class="katex"
                  ><span class="katex-mathml"
                    ><math
                      xmlns="http://www.w3.org/1998/Math/MathML"
                      display="block"
                      ><semantics
                        ><mrow
                          ><mi>G</mi><mo stretchy="false">(</mo><mi>T</mi
                          ><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn
                          ><mo>−</mo><munder><mo>∑</mo><mi>i</mi></munder
                          ><mi>P</mi><mo stretchy="false">(</mo><mi>i</mi
                          ><mi mathvariant="normal">∣</mi><mi>t</mi
                          ><msup
                            ><mo stretchy="false">)</mo><mn>2</mn></msup
                          ></mrow
                        ><annotation encoding="application/x-tex"
                          >G(T) = 1-\sum_i P(i|t)^2</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span class="mord mathnormal">G</span
                      ><span class="mopen">(</span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.13889em"
                        >T</span
                      ><span class="mclose">)</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span
                      ><span class="mrel">=</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 0.7278em; vertical-align: -0.0833em"
                      ></span
                      ><span class="mord">1</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span
                      ><span class="mbin">−</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 2.3277em; vertical-align: -1.2777em"
                      ></span
                      ><span class="mop op-limits"
                        ><span class="vlist-t vlist-t2"
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 1.05em"
                              ><span style="top: -1.8723em; margin-left: 0em"
                                ><span
                                  class="pstrut"
                                  style="height: 3.05em"
                                ></span
                                ><span class="sizing reset-size6 size3 mtight"
                                  ><span class="mord mathnormal mtight"
                                    >i</span
                                  ></span
                                ></span
                              ><span style="top: -3.05em"
                                ><span
                                  class="pstrut"
                                  style="height: 3.05em"
                                ></span
                                ><span
                                  ><span class="mop op-symbol large-op"
                                    >∑</span
                                  ></span
                                ></span
                              ></span
                            ><span class="vlist-s">​</span></span
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 1.2777em"
                              ><span></span></span></span></span></span
                      ><span
                        class="mspace"
                        style="margin-right: 0.1667em"
                      ></span
                      ><span
                        class="mord mathnormal"
                        style="margin-right: 0.13889em"
                        >P</span
                      ><span class="mopen">(</span
                      ><span class="mord mathnormal">i</span
                      ><span class="mord">∣</span
                      ><span class="mord mathnormal">t</span
                      ><span class="mclose"
                        ><span class="mclose">)</span
                        ><span class="msupsub"
                          ><span class="vlist-t"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8641em"
                                ><span
                                  style="top: -3.113em; margin-right: 0.05em"
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight">2</span></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ></span
                    ></span
                  ></span
                ></span
              >

              <h3 id="characteristics-of-a-decision-tree">
                Characteristics of a Decision Tree
              </h3>
              <p>
                Since DT easily ovefitted, we use pruning. Prune based on
                classification error threshold. Pros is that it is easy to
                interpret and implement.
              </p>

              <p>
                <img
                  src="/assets/images/IBM/DT_purity-error.png"
                  alt="smallcenter"
                />
              </p>

              <div class="language-python highlighter-rouge">
                <div class="highlight">
                  <pre
                    class="highlight"
                  ><code><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="n">DTC</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s">'Gini'</span><span class="p">,</span> <span class="n">max_Features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">DTC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">DTC</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre>
                </div>
              </div>

              <h2 id="ensemble">Ensemble</h2>
              <p>
                Combining prediction to reduce variance. We can reduce variance
                by pruning but pruning may lost generlization
              </p>

              <h3 id="bagging">Bagging</h3>
              <p>
                Bagging is bootstrap aggregating.Bagging is a tree ensemble that
                combines the prediction of several trees that were trained on
                bootstrap samples of the data. The underlying idea is that a
                model that averages the predictions of multiple models reduces
                the variance of a single model and has high chances to
                generalize well when scoring new data.<br />
                <strong>Pasting</strong> is when bootstrapping is held without
                replacement.
              </p>

              <p>Heterogeneous input data allowed, no preprocessing needed</p>

              <h4 id="out-of-bag-score">Out-of-Bag Score</h4>
              <p>
                OOB Scoring is the chance of not being selected<br />
                When there are
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow><mi>n</mi></mrow
                        ><annotation encoding="application/x-tex"
                          >n</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span class="strut" style="height: 0.4306em"></span
                      ><span class="mord mathnormal">n</span></span
                    ></span
                  ></span
                >
                samples, the chance for a sample not being selected is
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mn>1</mn><mo>−</mo
                          ><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow
                        ><annotation encoding="application/x-tex"
                          >1 - \frac{1}{n}</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 0.7278em; vertical-align: -0.0833em"
                      ></span
                      ><span class="mord">1</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span
                      ><span class="mbin">−</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.1901em; vertical-align: -0.345em"
                      ></span
                      ><span class="mord"
                        ><span class="mopen nulldelimiter"></span
                        ><span class="mfrac"
                          ><span class="vlist-t vlist-t2"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8451em"
                                ><span style="top: -2.655em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mathnormal mtight"
                                        >n</span
                                      ></span
                                    ></span
                                  ></span
                                ><span style="top: -3.23em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span
                                    class="frac-line"
                                    style="border-bottom-width: 0.04em"
                                  ></span></span
                                ><span style="top: -3.394em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mtight">1</span></span
                                    ></span
                                  ></span
                                ></span
                              ><span class="vlist-s">​</span></span
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.345em"
                                ><span></span></span></span></span></span
                        ><span
                          class="mclose nulldelimiter"
                        ></span></span></span></span></span
                >. Thus, probability of a sample being not selected after n
                draws is
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo
                          ><mfrac><mn>1</mn><mi>n</mi></mfrac
                          ><msup
                            ><mo stretchy="false">)</mo><mi>n</mi></msup
                          ></mrow
                        ><annotation encoding="application/x-tex"
                          >(1-\frac{1}{n})^n</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span class="mopen">(</span><span class="mord">1</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span
                      ><span class="mbin">−</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.1901em; vertical-align: -0.345em"
                      ></span
                      ><span class="mord"
                        ><span class="mopen nulldelimiter"></span
                        ><span class="mfrac"
                          ><span class="vlist-t vlist-t2"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8451em"
                                ><span style="top: -2.655em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mathnormal mtight"
                                        >n</span
                                      ></span
                                    ></span
                                  ></span
                                ><span style="top: -3.23em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span
                                    class="frac-line"
                                    style="border-bottom-width: 0.04em"
                                  ></span></span
                                ><span style="top: -3.394em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mtight">1</span></span
                                    ></span
                                  ></span
                                ></span
                              ><span class="vlist-s">​</span></span
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.345em"
                                ><span></span></span></span></span></span
                        ><span class="mclose nulldelimiter"></span></span
                      ><span class="mclose"
                        ><span class="mclose">)</span
                        ><span class="msupsub"
                          ><span class="vlist-t"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.6644em"
                                ><span
                                  style="top: -3.063em; margin-right: 0.05em"
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mathnormal mtight"
                                      >n</span
                                    ></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ></span
                    ></span
                  ></span
                >. When
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mi>n</mi><mo>→</mo
                          ><mi mathvariant="normal">∞</mi></mrow
                        ><annotation encoding="application/x-tex"
                          >n \to \infty</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span class="strut" style="height: 0.4306em"></span
                      ><span class="mord mathnormal">n</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span
                      ><span class="mrel">→</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span class="strut" style="height: 0.4306em"></span
                      ><span class="mord">∞</span></span
                    ></span
                  ></span
                >, the probability converges to
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mn>1</mn><mi mathvariant="normal">/</mi><mi>e</mi
                          ><mo>=</mo><mn>0.3678</mn></mrow
                        ><annotation encoding="application/x-tex"
                          >1/e = 0.3678</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span class="mord">1/</span
                      ><span class="mord mathnormal">e</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span
                      ><span class="mrel">=</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span class="strut" style="height: 0.6444em"></span
                      ><span class="mord">0.3678</span></span
                    ></span
                  ></span
                >.
              </p>

              <div class="language-python highlighter-rouge">
                <div class="highlight">
                  <pre
                    class="highlight"
                  ><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="n">bc</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">DTC</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">bc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre>
                </div>
              </div>

              <h4 id="random-forest">Random Forest</h4>
              <p>
                The bagged variance is
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><msup><mi>σ</mi><mn>2</mn></msup
                          ><mi mathvariant="normal">/</mi><mi>n</mi></mrow
                        ><annotation encoding="application/x-tex"
                          >\sigma^2 /n</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.0641em; vertical-align: -0.25em"
                      ></span
                      ><span class="mord"
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.03588em"
                          >σ</span
                        ><span class="msupsub"
                          ><span class="vlist-t"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8141em"
                                ><span
                                  style="top: -3.063em; margin-right: 0.05em"
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight">2</span></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ><span class="mord">/</span
                      ><span class="mord mathnormal">n</span></span
                    ></span
                  ></span
                >. However bootstrap samples are correlated
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mi>ρ</mi><msup><mi>σ</mi><mn>2</mn></msup
                          ><mo>+</mo
                          ><mfrac
                            ><mrow><mn>1</mn><mo>−</mo><mi>ρ</mi></mrow
                            ><mi>n</mi></mfrac
                          ><msup><mi>σ</mi><mn>2</mn></msup></mrow
                        ><annotation encoding="application/x-tex"
                          >\rho \sigma^2 + \frac{1-\rho}{n} \sigma^2</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.0085em; vertical-align: -0.1944em"
                      ></span
                      ><span class="mord mathnormal">ρ</span
                      ><span class="mord"
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.03588em"
                          >σ</span
                        ><span class="msupsub"
                          ><span class="vlist-t"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8141em"
                                ><span
                                  style="top: -3.063em; margin-right: 0.05em"
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight">2</span></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span
                      ><span class="mbin">+</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2222em"
                      ></span></span
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.2422em; vertical-align: -0.345em"
                      ></span
                      ><span class="mord"
                        ><span class="mopen nulldelimiter"></span
                        ><span class="mfrac"
                          ><span class="vlist-t vlist-t2"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8972em"
                                ><span style="top: -2.655em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mathnormal mtight"
                                        >n</span
                                      ></span
                                    ></span
                                  ></span
                                ><span style="top: -3.23em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span
                                    class="frac-line"
                                    style="border-bottom-width: 0.04em"
                                  ></span></span
                                ><span style="top: -3.4461em"
                                  ><span
                                    class="pstrut"
                                    style="height: 3em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight"
                                      ><span class="mord mtight">1</span
                                      ><span class="mbin mtight">−</span
                                      ><span class="mord mathnormal mtight"
                                        >ρ</span
                                      ></span
                                    ></span
                                  ></span
                                ></span
                              ><span class="vlist-s">​</span></span
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.345em"
                                ><span></span></span></span></span></span
                        ><span class="mclose nulldelimiter"></span></span
                      ><span class="mord"
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.03588em"
                          >σ</span
                        ><span class="msupsub"
                          ><span class="vlist-t"
                            ><span class="vlist-r"
                              ><span class="vlist" style="height: 0.8141em"
                                ><span
                                  style="top: -3.063em; margin-right: 0.05em"
                                  ><span
                                    class="pstrut"
                                    style="height: 2.7em"
                                  ></span
                                  ><span class="sizing reset-size6 size3 mtight"
                                    ><span class="mord mtight">2</span></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ></span
                    ></span
                  ></span
                >.<br />
                We introduce <strong>more randomness????</strong> to solve this.
                Use random subset of features ofr each tree, so that
                classification
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><msqrt><mi>m</mi></msqrt></mrow
                        ><annotation encoding="application/x-tex"
                          >\sqrt{m}</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1.04em; vertical-align: -0.2397em"
                      ></span
                      ><span class="mord sqrt"
                        ><span class="vlist-t vlist-t2"
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 0.8003em"
                              ><span class="svg-align" style="top: -3em"
                                ><span class="pstrut" style="height: 3em"></span
                                ><span
                                  class="mord"
                                  style="padding-left: 0.833em"
                                  ><span class="mord mathnormal">m</span></span
                                ></span
                              ><span style="top: -2.7603em"
                                ><span class="pstrut" style="height: 3em"></span
                                ><span
                                  class="hide-tail"
                                  style="min-width: 0.853em; height: 1.08em"
                                  ><svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="400em"
                                    height="1.08em"
                                    viewBox="0 0 400000 1080"
                                    preserveAspectRatio="xMinYMin slice"
                                  >
                                    <path
                                      d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"
                                    /></svg></span></span></span
                            ><span class="vlist-s">​</span></span
                          ><span class="vlist-r"
                            ><span class="vlist" style="height: 0.2397em"
                              ><span></span></span></span></span></span></span></span
                ></span>
                amd regression
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow
                          ><mi>m</mi><mi mathvariant="normal">/</mi
                          ><mn>3</mn></mrow
                        ><annotation encoding="application/x-tex"
                          >m/3</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 1em; vertical-align: -0.25em"
                      ></span
                      ><span class="mord mathnormal">m</span
                      ><span class="mord">/3</span></span
                    ></span
                  ></span
                >.
              </p>

              <p><img src="/assets/images/IBM/RFM.png" alt="smallcenter" /></p>

              <div class="language-python highlighter-rouge">
                <div class="highlight">
                  <pre
                    class="highlight"
                  ><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">rf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.ensamble</span> <span class="kn">import</span> <span class="n">ExtraTreesClassifier</span>
<span class="n">ec</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ec</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">ec</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre>
                </div>
              </div>

              <h2 id="boosting">Boosting</h2>
              <p>
                Weighting different trees differently to imporve. So we lower
                the weights of the records that the first model got right, and
                increase the weights of the ones that are wrongly classified and
                that’s the major idea here in boosting. And we put
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow><mi>λ</mi></mrow
                        ><annotation encoding="application/x-tex"
                          >\lambda</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span class="strut" style="height: 0.6944em"></span
                      ><span class="mord mathnormal">λ</span></span
                    ></span
                  ></span
                >
                to control the weight of each trees. Using a learning rate
                <span class="katex"
                  ><span class="katex-mathml"
                    ><math xmlns="http://www.w3.org/1998/Math/MathML"
                      ><semantics
                        ><mrow><mo>&lt;</mo><mn>1.0</mn></mrow
                        ><annotation encoding="application/x-tex"
                          >&lt; 1.0</annotation
                        ></semantics
                      ></math
                    ></span
                  ><span class="katex-html" aria-hidden="true"
                    ><span class="base"
                      ><span
                        class="strut"
                        style="height: 0.5782em; vertical-align: -0.0391em"
                      ></span
                      ><span class="mrel">&lt;</span
                      ><span
                        class="mspace"
                        style="margin-right: 0.2778em"
                      ></span></span
                    ><span class="base"
                      ><span class="strut" style="height: 0.6444em"></span
                      ><span class="mord">1.0</span></span
                    ></span
                  ></span
                >
                helps lessening the overfitting cases.<br />
                Boosting fit entire data set and base trees created
                successively, using residuals from previous models. Also this
                up-weight miscalssified points.
              </p>

              <h3 id="gradient-boosting-functions">
                Gradient Boosting Functions
              </h3>
              <ol>
                <li>
                  0-1 loss function ignores observations that were correctly
                  classified. The shape of this loss function makes it difficult
                  to optimize.
                </li>
                <li>
                  Adaboost is an adaptive boosting using
                  <span class="katex"
                    ><span class="katex-mathml"
                      ><math xmlns="http://www.w3.org/1998/Math/MathML"
                        ><semantics
                          ><mrow
                            ><msup
                              ><mi>e</mi
                              ><mrow
                                ><mo>−</mo><mi>m</mi><mi>a</mi><mi>r</mi
                                ><mi>g</mi><mi>i</mi><mi>n</mi><mi>a</mi
                                ><mi>l</mi></mrow
                              ></msup
                            ></mrow
                          ><annotation encoding="application/x-tex"
                            >e^{-marginal}</annotation
                          ></semantics
                        ></math
                      ></span
                    ><span class="katex-html" aria-hidden="true"
                      ><span class="base"
                        ><span class="strut" style="height: 0.8491em"></span
                        ><span class="mord"
                          ><span class="mord mathnormal">e</span
                          ><span class="msupsub"
                            ><span class="vlist-t"
                              ><span class="vlist-r"
                                ><span class="vlist" style="height: 0.8491em"
                                  ><span
                                    style="top: -3.063em; margin-right: 0.05em"
                                    ><span
                                      class="pstrut"
                                      style="height: 2.7em"
                                    ></span
                                    ><span
                                      class="sizing reset-size6 size3 mtight"
                                      ><span class="mord mtight"
                                        ><span class="mord mtight">−</span
                                        ><span class="mord mathnormal mtight"
                                          >ma</span
                                        ><span
                                          class="mord mathnormal mtight"
                                          style="margin-right: 0.02778em"
                                          >r</span
                                        ><span
                                          class="mord mathnormal mtight"
                                          style="margin-right: 0.03588em"
                                          >g</span
                                        ><span class="mord mathnormal mtight"
                                          >ina</span
                                        ><span
                                          class="mord mathnormal mtight"
                                          style="margin-right: 0.01968em"
                                          >l</span
                                        ></span
                                      ></span
                                    ></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ></span
                      ></span
                    ></span
                  >
                  as the loss function. 3. Gradient boosting uses
                  <span class="katex"
                    ><span class="katex-mathml"
                      ><math xmlns="http://www.w3.org/1998/Math/MathML"
                        ><semantics
                          ><mrow
                            ><mi>l</mi><mi>o</mi><mi>g</mi
                            ><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo
                            ><msup
                              ><mi>e</mi
                              ><mrow
                                ><mo>−</mo><mi>m</mi><mi>a</mi><mi>r</mi
                                ><mi>g</mi><mi>i</mi><mi>n</mi></mrow
                              ></msup
                            ><mo stretchy="false">)</mo></mrow
                          ><annotation encoding="application/x-tex"
                            >log(1+e^{-margin})</annotation
                          ></semantics
                        ></math
                      ></span
                    ><span class="katex-html" aria-hidden="true"
                      ><span class="base"
                        ><span
                          class="strut"
                          style="height: 1em; vertical-align: -0.25em"
                        ></span
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.01968em"
                          >l</span
                        ><span class="mord mathnormal">o</span
                        ><span
                          class="mord mathnormal"
                          style="margin-right: 0.03588em"
                          >g</span
                        ><span class="mopen">(</span><span class="mord">1</span
                        ><span
                          class="mspace"
                          style="margin-right: 0.2222em"
                        ></span
                        ><span class="mbin">+</span
                        ><span
                          class="mspace"
                          style="margin-right: 0.2222em"
                        ></span></span
                      ><span class="base"
                        ><span
                          class="strut"
                          style="height: 1.0747em; vertical-align: -0.25em"
                        ></span
                        ><span class="mord"
                          ><span class="mord mathnormal">e</span
                          ><span class="msupsub"
                            ><span class="vlist-t"
                              ><span class="vlist-r"
                                ><span class="vlist" style="height: 0.8247em"
                                  ><span
                                    style="top: -3.063em; margin-right: 0.05em"
                                    ><span
                                      class="pstrut"
                                      style="height: 2.7em"
                                    ></span
                                    ><span
                                      class="sizing reset-size6 size3 mtight"
                                      ><span class="mord mtight"
                                        ><span class="mord mtight">−</span
                                        ><span class="mord mathnormal mtight"
                                          >ma</span
                                        ><span
                                          class="mord mathnormal mtight"
                                          style="margin-right: 0.02778em"
                                          >r</span
                                        ><span
                                          class="mord mathnormal mtight"
                                          style="margin-right: 0.03588em"
                                          >g</span
                                        ><span class="mord mathnormal mtight"
                                          >in</span
                                        ></span
                                      ></span
                                    ></span
                                  ></span
                                ></span
                              ></span
                            ></span
                          ></span
                        ><span class="mclose">)</span></span
                      ></span
                    ></span
                  >
                  as the loss function.
                </li>
              </ol>

              <h3 id="hyperparameters">Hyperparameters</h3>
              <ul>
                <li>
                  <code class="language-plaintext highlighter-rouge"
                    >learning rate</code
                  >
                  for shrinkage
                </li>
                <li>
                  <code class="language-plaintext highlighter-rouge"
                    >Stochastic gradient boosting</code
                  >
                  subsample to use fraction of data for base learners
                </li>
                <li>
                  <code class="language-plaintext highlighter-rouge"
                    >max_features</code
                  >
                  number of features to use for each base learner But since we
                  cannot parallel trees, needs logn time.
                </li>
              </ul>

              <div class="language-python highlighter-rouge">
                <div class="highlight">
                  <pre
                    class="highlight"
                  ><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="n">gbc</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">abc</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">gbc</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># we set max_dept from gbc.
</span><span class="n">gbc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gbc</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre>
                </div>
              </div>

              <h3 id="stacking">Stacking</h3>
              <p>
                Stacking is a way to combine multiple models, but should be
                aware of increasing model complexity. The model prediction can
                be done by voting or with another model.
              </p>
              <h4 id="hard-voting-vs-soft-voting">
                Hard voting vs Soft voting
              </h4>

              <div class="language-python highlighter-rouge">
                <div class="highlight">
                  <pre
                    class="highlight"
                  ><code><span class="kn">from</span> <span class="nn">sklearn.ensamble</span> <span class="kn">import</span> <span class="n">VotingClassifier</span>
<span class="n">vc</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s">'rf'</span><span class="p">,</span> <span class="n">rf</span><span class="p">),</span> <span class="p">(</span><span class="s">'gbc'</span><span class="p">,</span> <span class="n">gbc</span><span class="p">),</span> <span class="p">(</span><span class="s">'abc'</span><span class="p">,</span> <span class="n">abc</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s">'hard'</span><span class="p">)</span>
<span class="n">vc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">vc</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.emsable</span> <span class="kn">import</span> <span class="n">StakingClassifier</span> <span class="c1">#work similarly
</span></code></pre>
                </div>
              </div>
            </section>

            <footer class="page__meta"></footer>

            <section class="page__share">
              <h4 class="page__share-title">Share on</h4>

              <a
                href="https://twitter.com/intent/tweet?text=Decision+Tree%20https%3A%2F%2Fleeway00.github.io%2Fibm%2Fcls3%2F"
                class="btn btn--twitter"
                onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on Twitter"
                ><i class="fab fa-fw fa-twitter" aria-hidden="true"></i
                ><span> Twitter</span></a
              >

              <a
                href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fleeway00.github.io%2Fibm%2Fcls3%2F"
                class="btn btn--facebook"
                onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on Facebook"
                ><i class="fab fa-fw fa-facebook" aria-hidden="true"></i
                ><span> Facebook</span></a
              >

              <a
                href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fleeway00.github.io%2Fibm%2Fcls3%2F"
                class="btn btn--linkedin"
                onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"
                title="Share on LinkedIn"
                ><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i
                ><span> LinkedIn</span></a
              >
            </section>

            <nav class="pagination">
              <a
                href="/ibm/cls2/"
                class="pagination--pager"
                title="KNN and SVM
"
                >Previous</a
              >

              <a
                href="/ibm/cls4/"
                class="pagination--pager"
                title="Unbalanced Classes
"
                >Next</a
              >
            </nav>
          </div>

          <div class="page__comments">
            <h4 class="page__comments-title">Leave a comment</h4>
            <section
              class="fb-comments"
              data-href="https://leeway00.github.io/ibm/cls3/"
              data-mobile="true"
              data-num-posts="5"
              data-width="100%"
              data-colorscheme="light"
            ></section>
          </div>
        </article>

        <div class="page__related">
          <h2 class="page__related-title">You may also enjoy</h2>
          <div class="grid__wrapper">
            <div class="grid__item">
              <article
                class="archive__item"
                itemscope
                itemtype="https://schema.org/CreativeWork"
              >
                <h2 class="archive__item-title no_toc" itemprop="headline">
                  <a href="/ibm/proj1/" rel="permalink"
                    >Machine Learning on Apple stock daily return
                  </a>
                </h2>

                <p class="page__meta">
                  <span class="page__meta-readtime">
                    <i class="far fa-clock" aria-hidden="true"></i>

                    19 minute read
                  </span>
                </p>

                <p class="archive__item-excerpt" itemprop="description">
                  import numpy as np import pandas as pd import os import
                  matplotlib.pyplot as plt %matplotlib inline import seaborn as
                  sns
                </p>
              </article>
            </div>

            <div class="grid__item">
              <article
                class="archive__item"
                itemscope
                itemtype="https://schema.org/CreativeWork"
              >
                <h2 class="archive__item-title no_toc" itemprop="headline">
                  <a href="/ibm/dl6/" rel="permalink"
                    >Reinforcement Learning
                  </a>
                </h2>

                <p class="page__meta">
                  <span class="page__meta-readtime">
                    <i class="far fa-clock" aria-hidden="true"></i>

                    less than 1 minute read
                  </span>
                </p>

                <p class="archive__item-excerpt" itemprop="description">
                  Reinforcement Learning Agents interact with an Environment
                  Choose from a set of available actions Actions impact the
                  environment, which impacts agents...
                </p>
              </article>
            </div>

            <div class="grid__item">
              <article
                class="archive__item"
                itemscope
                itemtype="https://schema.org/CreativeWork"
              >
                <h2 class="archive__item-title no_toc" itemprop="headline">
                  <a href="/ibm/dl5/" rel="permalink">Autoencoder and GAN </a>
                </h2>

                <p class="page__meta">
                  <span class="page__meta-readtime">
                    <i class="far fa-clock" aria-hidden="true"></i>

                    1 minute read
                  </span>
                </p>

                <p class="archive__item-excerpt" itemprop="description">
                  Autoencoder Several applications: Dimensional reduction
                  Preprocessing for classification Identifying essential
                  elements of the input data and filterin...
                </p>
              </article>
            </div>

            <div class="grid__item">
              <article
                class="archive__item"
                itemscope
                itemtype="https://schema.org/CreativeWork"
              >
                <h2 class="archive__item-title no_toc" itemprop="headline">
                  <a href="/quant/mltf/" rel="permalink"
                    >Using Machine Learning in Trading and Finance
                  </a>
                </h2>

                <p class="page__meta">
                  <span class="page__meta-readtime">
                    <i class="far fa-clock" aria-hidden="true"></i>

                    less than 1 minute read
                  </span>
                </p>

                <p class="archive__item-excerpt" itemprop="description">
                  Endogenous and Exogenous trading rule Endo: long/short
                  decision based on price data Exgo: uses other factors to make
                  decision Are stock price...
                </p>
              </article>
            </div>
          </div>
        </div>
      </div>

      <!-- <script>
    var elements = document.querySelectorAll('.page__content.e-content').childNodes; // 수정1 
    var addContent = false;
    var contentsToAdd = [];
    var expandtags = null;
    var detailText = null;
    var detailsTag = null;
    var summaryTag = null;
    var detailsContent = null;
    for (var i=elements.length - 1; i > -1; i--){
        el = elements[i]
        if (el.innerHTML == '[/expand]'){
            addContent = true
            detailsContent = document.createElement('div')
            detailsContent.className = 'collaspe-content'
            detailsContent.setAttribute('markdown', '1')
            el.parentNode.removeChild(el)
        } else if (el.innerHTML == '[expand]' || (el.nodeName == 'P' && el.innerHTML.includes('[expand]summary:'))) {
            addContent = false
            expandtags = el.innerHTML.split('summary:')
            if (expandtags.length == 1){
                detailText = 'Details'
            } else {
                detailText = expandtags[1]
            }
            detailsTag = document.createElement('details')
            detailsTag.className = 'collaspe-article'
            summaryTag = document.createElement('summary')
            summaryTag.appendChild(document.createTextNode(detailText))
            detailsTag.appendChild(summaryTag)
            for (var j=contentsToAdd.length - 1; j > -1; j--) {
                detailsContent.appendChild(contentsToAdd[j])
            }
            detailsTag.appendChild(detailsContent)
            el.parentNode.replaceChild(detailsTag, el)
            contentsToAdd = []
        } else {
            if (addContent) {
                contentsToAdd.push(el)
            }
        }
    }
</script> -->
    </div>

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

        <!-- end custom footer snippets -->
        <!-- <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div> -->

        <div class="page__footer-copyright">
          &copy; 2022 Younghun Lee. Powered by
          <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp;
          <a
            href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/"
            rel="nofollow"
            >Minimal Mistakes</a
          >.
        </div>
      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>

    <div id="fb-root"></div>
    <script>
      (function (d, s, id) {
        var js,
          fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
        fjs.parentNode.insertBefore(js, fjs);
      })(document, "script", "facebook-jssdk");
    </script>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css"
      integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
      integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p"
      crossorigin="anonymous"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"
      integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
      crossorigin="anonymous"
      onload="renderMathInElement(document.body);"
    ></script>
  </body>
</html>
